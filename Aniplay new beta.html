<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AniPlay Pro Max - Ultimate Mix</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-storage-compat.js"></script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<style>
  :root {
    --primary: #ff0000;
    --accent: #00d4ff;
    --bg: #050505;
    --card-bg: #121212;
    --surface: #1e1e1e;
    --text-main: #ffffff;
    --text-dim: #aaaaaa;
    --border: #2a2a2a;
    --glass: rgba(255, 255, 255, 0.05);
  }

  * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
  body { margin: 0; padding: 0; background: var(--bg); color: var(--text-main); font-family: 'Inter', sans-serif; overflow-x: hidden; }

  /* Header */
  header {
    background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(15px);
    padding: 15px 20px; position: sticky; top: 0; z-index: 1000;
    border-bottom: 1px solid var(--border); display: flex; flex-direction: column; gap: 12px;
  }
  .header-top { display: flex; justify-content: space-between; align-items: center; }
  .logo-area { display: flex; align-items: center; gap: 8px; }
  .logo-area i { color: var(--primary); font-size: 24px; }
  .logo-text { font-size: 22px; font-weight: 800; }
  
  .user-badge { background: var(--glass); padding: 5px 12px; border-radius: 20px; font-size: 12px; border: 1px solid var(--border); display: flex; align-items: center; gap: 6px; }
  .online-dot { width: 8px; height: 8px; background: #00ff00; border-radius: 50%; box-shadow: 0 0 10px #00ff00; }

  .search-container { position: relative; width: 100%; }
  .search-container input { width: 100%; background: var(--surface); border: 1px solid var(--border); padding: 12px 15px 12px 40px; border-radius: 12px; color: white; }
  .search-container i { position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: var(--text-dim); }

  /* UI Elements */
  .hero-slider { padding: 20px; height: 160px; background: linear-gradient(45deg, #121212, #250000); margin: 15px; border-radius: 20px; display: flex; align-items: center; justify-content: center; text-align: center; border: 1px solid var(--border); }
  .video-grid { padding: 20px; display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 15px; margin-bottom: 80px; }
  .video-card { background: var(--card-bg); border-radius: 12px; overflow: hidden; border: 1px solid var(--border); cursor: pointer; }
  .thumb-box { aspect-ratio: 16/9; background: #222; display: flex; align-items: center; justify-content: center; color: #444; overflow: hidden; }
  .thumb-box img { width: 100%; height: 100%; object-fit: cover; }
  .video-info { padding: 10px; font-size: 13px; font-weight: 600; }

  /* Modals */
  .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 6000; display: none; align-items: center; justify-content: center; padding: 20px; }
  .modal-box { background: var(--card-bg); width: 100%; max-width: 400px; border-radius: 20px; padding: 25px; border: 1px solid var(--border); position: relative; }
  
  .close-btn { position: absolute; top: 15px; right: 15px; font-size: 20px; color: var(--text-dim); cursor: pointer; }
  .close-btn:hover { color: var(--primary); }

  .form-group { margin-bottom: 15px; }
  .form-group input { width: 100%; padding: 12px; background: var(--bg); border: 1px solid var(--border); border-radius: 10px; color: white; }
  .btn-premium { width: 100%; padding: 14px; background: var(--primary); border: none; border-radius: 10px; color: white; font-weight: 800; cursor: pointer; margin-bottom: 10px; }
  .google-btn { background: white !important; color: black !important; }

  /* Player Overlay */
  #videoPlayerOverlay { position: fixed; inset: 0; background: #000; z-index: 7000; display: none; flex-direction: column; }
  video { width: 100%; aspect-ratio: 16/9; background: #000; }
  .player-info { padding: 20px; flex: 1; overflow-y: auto; }

  .bottom-nav { position: fixed; bottom: 0; width: 100%; background: #0a0a0a; display: flex; padding: 12px 0; border-top: 1px solid var(--border); z-index: 999; }
  .nav-btn { flex: 1; text-align: center; color: var(--text-dim); font-size: 10px; cursor: pointer; }
  .nav-btn i { font-size: 18px; display: block; margin-bottom: 4px; }
  .nav-btn.active { color: var(--primary); }
</style>
</head>
<body>

<header>
  <div class="header-top">
    <div class="logo-area"><i class="fas fa-play-circle"></i><span class="logo-text">ANIPLAY<span style="color:var(--primary)">PRO</span></span></div>
    <div class="user-badge"><div class="online-dot"></div><span id="uNameDisplay">Guest</span></div>
  </div>
  <div class="search-container"><i class="fas fa-search"></i><input type="text" id="searchInput" placeholder="Search videos..."></div>
</header>

<div class="hero-slider">
  <div><h2>Premium Anime</h2><p style="color:var(--text-dim); font-size: 11px;">Watch HD Quality Content Free</p></div>
</div>

<div id="videoGrid" class="video-grid"></div>

<div id="authModal" class="modal-overlay">
  <div class="modal-box">
    <i class="fas fa-times close-btn" onclick="closeModal('authModal')"></i>
    <h2 style="text-align:center;">ACCESS ACCOUNT</h2>
    <div class="form-group"><input type="email" id="authEmail" placeholder="Email"></div>
    <div class="form-group"><input type="password" id="authPass" placeholder="Password"></div>
    <div id="signupOnly" style="display:none;"><div class="form-group"><input type="text" id="authName" placeholder="Full Name"></div></div>
    <button class="btn-premium" onclick="processAuth()" id="authMainBtn">LOG IN</button>
    <button onclick="loginWithGoogle()" class="btn-premium google-btn">
      <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" width="16" style="margin-right:8px"> Sign in with Google
    </button>
    <p style="text-align:center; font-size:12px; margin-top:10px; color:var(--text-dim)">
      <span id="authToggleBtn" onclick="toggleAuthMode()" style="color:var(--accent); cursor:pointer;">New User? Sign Up</span>
    </p>
  </div>
</div>

<div id="uploadModal" class="modal-overlay">
    <div class="modal-box">
      <i class="fas fa-times close-btn" onclick="closeModal('uploadModal')"></i>
      <h2 style="text-align:center;">UPLOAD</h2>
      <div class="form-group"><input type="text" id="upTitle" placeholder="Video Title"></div>
      <div class="form-group"><input type="file" id="upFile" accept="video/*"></div>
      <button class="btn-premium" id="finalUpBtn" onclick="startUpload()">PUBLISH</button>
      <p id="upStatusLabel" style="text-align:center; font-size:11px;"></p>
    </div>
</div>

<div id="videoPlayerOverlay">
    <div style="padding:15px; cursor:pointer" onclick="closeVideoPlayer()"><i class="fas fa-chevron-down"></i> BACK</div>
    <video id="mainVid" controls></video>
    <div class="player-info">
        <h2 id="pTitle">Video Title</h2>
        <p id="pUploader" style="color:var(--accent)">By Uploader</p>
    </div>
</div>

<div class="bottom-nav">
  <div class="nav-btn active" onclick="location.reload()"><i class="fas fa-home"></i>HOME</div>
  <div class="nav-btn" onclick="openModal('uploadModal')"><i class="fas fa-plus"></i>UPLOAD</div>
  <div class="nav-btn" onclick="openProfile()"><i class="fas fa-user-circle"></i>ACCOUNT</div>
</div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyCCwrWqiHudNUyS9rGyZqa1opwTN2bwIdY",
  authDomain: "aniplay-d22bd.firebaseapp.com",
  projectId: "aniplay-d22bd",
  storageBucket: "aniplay-d22bd.appspot.com",
  databaseURL: "https://aniplay-d22bd-default-rtdb.firebaseio.com",
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const auth = firebase.auth();
const storage = firebase.storage();

// Modals
function openModal(id) { 
    if(id === 'uploadModal' && !auth.currentUser) return openModal('authModal');
    document.getElementById(id).style.display = 'flex'; 
}
function closeModal(id) { document.getElementById(id).style.display = 'none'; }

// Auth Logic
let isSignupMode = false;
function toggleAuthMode() {
    isSignupMode = !isSignupMode;
    document.getElementById('authMainBtn').innerText = isSignupMode ? "CREATE ACCOUNT" : "LOG IN";
    document.getElementById('signupOnly').style.display = isSignupMode ? "block" : "none";
}

function processAuth() {
    const email = document.getElementById('authEmail').value;
    const pass = document.getElementById('authPass').value;
    if(isSignupMode) {
        auth.createUserWithEmailAndPassword(email, pass).then(res => {
            res.user.updateProfile({displayName: document.getElementById('authName').value});
            location.reload();
        }).catch(e => alert(e.message));
    } else {
        auth.signInWithEmailAndPassword(email, pass).then(() => location.reload()).catch(e => alert(e.message));
    }
}

function loginWithGoogle() {
    const provider = new firebase.auth.GoogleAuthProvider();
    auth.signInWithPopup(provider).then(() => location.reload()).catch(e => alert(e.message));
}

function openProfile() {
    if(auth.currentUser) {
        if(confirm("Logout from " + (auth.currentUser.displayName || auth.currentUser.email) + "?")) 
            auth.signOut().then(() => location.reload());
    } else {
        openModal('authModal');
    }
}

// Data Logic
let allVids = [];
db.ref('videos').on('value', snap => {
    const grid = document.getElementById('videoGrid');
    grid.innerHTML = "";
    allVids = [];
    snap.forEach(child => {
        const d = child.val(); d.id = child.key;
        allVids.push(d);
        grid.innerHTML += `
            <div class="video-card" onclick="openVideoPlayer('${d.id}')">
                <div class="thumb-box"><i class="fas fa-play"></i></div>
                <div class="video-info">${d.title}</div>
                <div style="font-size:10px; color:gray; padding:0 10px 10px;">${d.uploader || 'Anonymous'}</div>
            </div>`;
    });
});

function openVideoPlayer(id) {
    const v = allVids.find(x => x.id === id);
    if(!v) return;
    document.getElementById('mainVid').src = v.videoUrl;
    document.getElementById('pTitle').innerText = v.title;
    document.getElementById('pUploader').innerText = "By " + v.uploader;
    document.getElementById('videoPlayerOverlay').style.display = 'flex';
}

function closeVideoPlayer() {
    document.getElementById('mainVid').pause();
    document.getElementById('videoPlayerOverlay').style.display = 'none';
}

function startUpload() {
    const file = document.getElementById('upFile').files[0];
    const title = document.getElementById('upTitle').value;
    if(!file || !title) return alert("Please fill all fields!");
    
    document.getElementById('finalUpBtn').disabled = true;
    const task = storage.ref('videos/' + Date.now()).put(file);
    
    task.on('state_changed', s => {
        const p = Math.round((s.bytesTransferred / s.totalBytes) * 100);
        document.getElementById('upStatusLabel').innerText = "Uploading: " + p + "%";
    }, null, () => {
        task.snapshot.ref.getDownloadURL().then(url => {
            db.ref('videos').push({
                title, videoUrl: url, 
                uploader: auth.currentUser.displayName || auth.currentUser.email
            });
            location.reload();
        });
    });
}

auth.onAuthStateChanged(u => {
    if(u) document.getElementById('uNameDisplay').innerText = u.displayName || u.email.split('@')[0];
});

// Close modal on outside click
window.onclick = e => { if(e.target.className === 'modal-overlay') e.target.style.display = 'none'; }
</script>
</body>
</html>
